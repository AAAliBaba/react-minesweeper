{"ast":null,"code":"var _jsxFileName = \"/Users/arafatarman/Documents/ReactProjects/minesweeper/src/index.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport * as helpers from './helpers.js';\n\nfunction Cell(props) {\n  return React.createElement(\"p\", {\n    className: \"cell\",\n    onClick: props.onClick,\n    onContextMenu: props.onClick,\n    style: {\n      backgroundColor: props.bg_color\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 8\n    },\n    __self: this\n  }, props.face);\n} //globals, these arrays help us check the neighbors of a cell.\n\n\nvar neighbor_rows = [-1, -1, -1, 0, 0, 1, 1, 1];\nvar neighbor_cols = [-1, 0, 1, -1, 1, -1, 0, 1]; //more globals, to avoid direct mutation of Board states\n\nvar bool_arr = [];\nvar val_arr = [];\nvar flag_arr = [];\nvar val_arr_isInitialized = false;\n\nfor (var i = 0; i < 9; i++) {\n  bool_arr[i] = new Array(9);\n  val_arr[i] = new Array(9);\n  flag_arr[i] = new Array(9);\n}\n\nclass Board extends React.Component {\n  constructor(props) {\n    super(props);\n    var init = [];\n\n    for (var i = 0; i < 9; i++) {\n      init[i] = new Array(9);\n    }\n\n    helpers.init_board(init);\n\n    for (var k = 0; k < 9; k++) {\n      for (var j = 0; j < 9; j++) {\n        var val = init[k][j];\n        init[k][j] = this.renderCell(k, j, val, \"\", \"white\");\n      }\n    }\n\n    this.state = {\n      cells: init,\n      mines: 10,\n      revealed_cells: 0,\n      did_lose: false,\n      did_win: false\n    };\n  }\n\n  reveal(row, col) {\n    if (flag_arr[row][col]) return; //can't reveal a flagged cell.\n    else if (val_arr[row][col] === 0 && !bool_arr[row][col]) {\n        bool_arr[row][col] = true;\n\n        for (var i = 0; i < 9; i++) {\n          var row_to_check = row + neighbor_rows[i];\n          var col_to_check = col + neighbor_cols[i];\n          if (row_to_check < 0 || row_to_check >= 9 || col_to_check < 0 || col_to_check >= 9) continue; //out of bounds\n\n          if (isNaN(row_to_check) || isNaN(col_to_check)) break; //weird error I was getting after a recursive call returned.\n\n          this.reveal(row_to_check, col_to_check);\n        }\n      } else bool_arr[row][col] = true;\n  }\n\n  flag(row, col) {\n    if (!bool_arr[row][col] || flag_arr[row][col]) {\n      flag_arr[row][col] = !flag_arr[row][col];\n      var m = this.state.mines;\n      flag_arr[row][col] ? this.setState({\n        mines: m - 1\n      }) : this.setState({\n        mines: m + 1\n      });\n    }\n  }\n\n  handleClick(row, col, event) {\n    if (this.state.did_lose || this.state.did_win) return;\n    event.preventDefault(); //need this so menu doesn't pop up when we right click\n\n    var cells_copy = [];\n    var rev_cells_cnt = 0;\n\n    for (var i = 0; i < 9; i++) {\n      cells_copy[i] = new Array(9);\n    }\n\n    if (!val_arr_isInitialized) {\n      for (var j = 0; j < 9; j++) {\n        for (var k = 0; k < 9; k++) {\n          this.state.cells[j][k].props.face === \"\" ? bool_arr[j][k] = false : bool_arr[j][k] = true;\n          val_arr[j][k] = this.state.cells[j][k].props.value;\n          flag_arr[j][k] = false;\n        }\n      }\n\n      val_arr_isInitialized = true;\n    }\n\n    if (event.type === 'click') this.reveal(row, col);else this.flag(row, col);\n    var didLose = false;\n\n    for (var r = 0; r < 9; r++) {\n      for (var c = 0; c < 9; c++) {\n        if (bool_arr[r][c]) {\n          if (this.state.cells[r][c].props.value === \"*\") {\n            didLose = true;\n            cells_copy[r][c] = this.renderCell(r, c, this.state.cells[r][c].props.value, this.state.cells[r][c].props.value, \"lightcoral\");\n          } else cells_copy[r][c] = this.renderCell(r, c, this.state.cells[r][c].props.value, this.state.cells[r][c].props.value, \"lightgrey\");\n\n          rev_cells_cnt++;\n        } else if (flag_arr[r][c]) {\n          cells_copy[r][c] = this.renderCell(r, c, this.state.cells[r][c].props.value, \"M\", \"white\");\n          rev_cells_cnt++;\n        } else cells_copy[r][c] = this.renderCell(r, c, this.state.cells[r][c].props.value, \"\", \"white\");\n      }\n    }\n\n    if (rev_cells_cnt === 81) this.setState({\n      cells: cells_copy,\n      revealed_cells: rev_cells_cnt,\n      did_lose: didLose,\n      did_win: true\n    });else this.setState({\n      cells: cells_copy,\n      revealed_cells: rev_cells_cnt,\n      did_lose: didLose\n    });\n  }\n\n  renderCell(r, c, v, f, bgc) {\n    return React.createElement(Cell, {\n      row: r,\n      col: c,\n      value: v,\n      face: f,\n      onClick: event => this.handleClick(r, c, event),\n      bg_color: bgc,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    });\n  }\n\n  render() {\n    if (this.state.init === null) return null;\n    let status;\n    if (this.state.did_lose) status = \"You Lose!\";else if (this.state.did_win) status = \"You Win!\";else status = \"# of mines: \" + this.state.mines;\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, status)), React.createElement(\"div\", {\n      className: \"grid\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, this.state.cells));\n  }\n\n}\n\nclass Game extends React.Component {\n  render() {\n    return React.createElement(\"div\", {\n      className: \"game\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \"React.Minesweeper\"), React.createElement(Board, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }));\n  }\n\n}\n\nReactDOM.render(React.createElement(Game, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 198\n  },\n  __self: this\n}), document.getElementById('root'));","map":{"version":3,"sources":["/Users/arafatarman/Documents/ReactProjects/minesweeper/src/index.js"],"names":["React","ReactDOM","helpers","Cell","props","onClick","backgroundColor","bg_color","face","neighbor_rows","neighbor_cols","bool_arr","val_arr","flag_arr","val_arr_isInitialized","i","Array","Board","Component","constructor","init","init_board","k","j","val","renderCell","state","cells","mines","revealed_cells","did_lose","did_win","reveal","row","col","row_to_check","col_to_check","isNaN","flag","m","setState","handleClick","event","preventDefault","cells_copy","rev_cells_cnt","value","type","didLose","r","c","v","f","bgc","render","status","Game","document","getElementById"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport * as helpers from './helpers.js';\n\nfunction Cell(props) {\n        return (\n            <p className=\"cell\" onClick={props.onClick} onContextMenu={props.onClick} style={{backgroundColor: props.bg_color}}>\n                {props.face}\n            </p>\n        );\n}\n\n//globals, these arrays help us check the neighbors of a cell.\nvar neighbor_rows = [-1, -1, -1, 0, 0,   1, 1, 1];\nvar neighbor_cols = [-1,  0,  1, -1, 1, -1, 0, 1];\n\n//more globals, to avoid direct mutation of Board states\nvar bool_arr = [];\nvar val_arr = [];\nvar flag_arr = [];\nvar val_arr_isInitialized = false;\n\nfor(var i = 0; i < 9; i++)\n{\n    bool_arr[i] = new Array(9);\n    val_arr[i] = new Array(9);\n    flag_arr[i] = new Array(9);\n}\n\nclass Board extends React.Component {\n    constructor(props) {\n        super(props);\n\n        var init = [];\n        for(var i = 0; i < 9; i++)\n        {\n            init[i] = new Array(9);\n        }\n        helpers.init_board(init);\n\n        for(var k = 0; k < 9; k++)\n        {\n            for(var j = 0; j < 9; j++)\n            {\n                var val = init[k][j];\n                init[k][j] = this.renderCell(k, j, val, \"\", \"white\");\n            }\n        }\n\n        this.state = {\n            cells: init,\n            mines: 10,\n            revealed_cells: 0,\n            did_lose: false,\n            did_win: false,\n        }\n    }\n\n    reveal(row, col) {\n        if(flag_arr[row][col])\n            return; //can't reveal a flagged cell.\n        else if(val_arr[row][col] === 0 && !bool_arr[row][col])\n        {\n            bool_arr[row][col] = true;\n\n            for(var i = 0; i < 9; i++)\n            {\n                var row_to_check = row + neighbor_rows[i];\n                var col_to_check = col + neighbor_cols[i];\n\n                if(row_to_check < 0 || row_to_check >= 9 || col_to_check < 0 || col_to_check >= 9)\n                    continue; //out of bounds\n\n                if(isNaN(row_to_check) || isNaN(col_to_check))\n                    break; //weird error I was getting after a recursive call returned.\n\n                this.reveal(row_to_check, col_to_check);\n            }\n        }\n        else\n            bool_arr[row][col] = true;\n    }\n\n    flag(row, col) {\n        if(!bool_arr[row][col] || flag_arr[row][col])\n        {\n            flag_arr[row][col] = !flag_arr[row][col];\n            var m = this.state.mines;\n            flag_arr[row][col] ? this.setState({mines: (m - 1)}) : this.setState({mines: (m + 1)});\n        }\n    }\n\n    handleClick(row, col, event) {\n        if(this.state.did_lose || this.state.did_win)\n            return;\n\n        event.preventDefault(); //need this so menu doesn't pop up when we right click\n\n        var cells_copy = [];\n        var rev_cells_cnt = 0;\n        for(var i = 0; i < 9; i++)\n        {\n            cells_copy[i] = new Array(9);\n        }\n\n        if(!val_arr_isInitialized) {\n            for(var j = 0; j < 9; j++)\n            {\n                for(var k = 0; k < 9; k++)\n                {\n                    this.state.cells[j][k].props.face === \"\" ? bool_arr[j][k] = false : bool_arr[j][k] = true;\n                    val_arr[j][k] = this.state.cells[j][k].props.value;\n                    flag_arr[j][k] = false;\n                }\n            }\n            val_arr_isInitialized = true;\n        }\n\n        if(event.type === 'click')\n            this.reveal(row, col);\n        else\n            this.flag(row, col);\n\n        var didLose = false;\n        for(var r = 0; r < 9; r++)\n        {\n            for(var c = 0; c < 9; c++)\n            {\n                if(bool_arr[r][c])\n                {\n                    if(this.state.cells[r][c].props.value === \"*\")\n                    {\n                        didLose = true;\n                        cells_copy[r][c] = this.renderCell(r, c, (this.state.cells[r][c].props.value), (this.state.cells[r][c].props.value), \"lightcoral\");\n                    }\n                    else\n                        cells_copy[r][c] = this.renderCell(r, c, (this.state.cells[r][c].props.value), (this.state.cells[r][c].props.value), \"lightgrey\");\n                    \n                    rev_cells_cnt++;\n                }\n                else if(flag_arr[r][c])\n                {\n                    cells_copy[r][c] = this.renderCell(r, c, (this.state.cells[r][c].props.value), \"M\", \"white\");\n                    rev_cells_cnt++;\n                }\n                else\n                    cells_copy[r][c] = this.renderCell(r, c, (this.state.cells[r][c].props.value), \"\", \"white\");\n            }\n        }\n\n        if(rev_cells_cnt === 81)\n            this.setState({cells: cells_copy, revealed_cells: rev_cells_cnt, did_lose: didLose, did_win: true});\n        else    \n            this.setState({cells: cells_copy, revealed_cells: rev_cells_cnt, did_lose: didLose});    \n    }\n\n    renderCell(r, c, v, f, bgc) {\n        return <Cell row={r} col={c} value={v} face={f} onClick={(event) => this.handleClick(r, c, event)} bg_color={bgc}/>\n    }\n\n    render() {\n        if (this.state.init === null) return null;\n\n        let status;\n        if(this.state.did_lose)\n            status = \"You Lose!\";\n        else if(this.state.did_win)\n            status = \"You Win!\";\n        else\n            status = \"# of mines: \" + this.state.mines;\n\n        return (\n            <div>\n                <div>\n                    <h3>{status}</h3>\n                </div>\n                <div className=\"grid\">\n                    {this.state.cells}\n                </div>\n            </div>\n        )\n    }\n}\n\nclass Game extends React.Component {\n    render() {\n        return(\n            <div className=\"game\">\n                <h2>React.Minesweeper</h2>\n                <Board />\n            </div>\n        );\n    }\n}\n\nReactDOM.render(\n    <Game />,\n    document.getElementById('root')\n  );"]},"metadata":{},"sourceType":"module"}